---
.colors: &colors
  yellow:         &yellow           '#F5DDA9'
  darkblue:       &darkblue         '#2F7194'
  red:            &red              '#ec7070'
  skyblue:        &skyblue          '#97c3d0'
  darkgreen:      &darkgreen        '#48675A'
  lightbrown:     &lightbrown       '#C6BFA2'
  orange:         &orange           '#EC9F7E'
  lightgreen:     &lightgreen       '#AFD8BC'
  grey:           &grey             '#3D4244'

predictions:
  based_on: heatmap
  select:
    data: VPINN/predictions

frames:
  based_on:
    - .creator.universe
    - .plot.facet_grid.line
    - .plot.facet_grid.with_auto_encoding
  select:
    data:
      path: VPINN/predictions
      transform:
        - .isel: [!dag_prev , {y: !slice [~, ~, 32]}]
  col: y
loss:
  based_on: loss
  helpers:
    set_scales:
      y: log

grid:
  based_on: grid2d

grid_boundary:
  based_on: grid_boundary2d

boundary_conditions:
  based_on:
    - .creator.universe
    - .plot.facet_grid.scatter
  select:
    vals: data/u_exact_boundary
  transform:
    - .sel: [!dag_tag vals , {'variable': 'x'}]
      kwargs:
        drop: True
      tag: x
    - .sel: [!dag_tag vals , {'variable': 'u'}]
      kwargs:
        drop: True
      tag: u
    - xr.Dataset:
      - x: !dag_tag x
        u: !dag_tag u
      tag: data
  x: x
  y: u
  hue: u
  cmap:
    continuous: true
    from_values:
      0: *darkblue
      0.5: *yellow
      1: *red

test_functions:
  based_on: heatmap
  select:
    data:
      path: data/test_function_values
      transform:
        - .isel: [!dag_prev , {n_x: !range [3], n_y: !range [3]}]
  row: n_x
  col: n_y

# Plot the first x-derivatives of the test functions (first three test functions in each direction)
d1test_functions_x:
  based_on: test_functions
  select:
    data:
      path: data/d1_test_function_values
      transform:
        - .isel: [!dag_prev , {n_x: !range [3], n_y: !range [3], idx: 0}]
  cbar_kwargs:
    label: $\partial_x \nu_{kl}$

# Plot the first y-derivatives of the test functions
d1test_functions_y:
  based_on: test_functions
  select:
    data:
      path: data/d1_test_function_values
      transform:
        - .isel: [!dag_prev , {n_x: !range [3], n_y: !range [3], idx: 1}]
  cbar_kwargs:
    label: $\partial_y \nu_{kl}$
